---
title: "Rrrrемарки!"
output: html_notebook
---
Пересдача 19/09

## Что тут будет происходить
У меня есть много-много авторских ремарок, в которых указана доля тех или иных частей речи.

1) Их [частей речи] много — возможно, получится с помощью PCA уменьшить количество частей речи, и использовать не целое множество разных признаков, а пару-тройку?
2) И заодно тогда попробовать кластеризовать их и посмотреть, как сильно это будет отличаться от той разметки, которую я сделала руками.

```{r}
library(tidyverse)
library(ggfortify)
library(GGally)
```
### 1. PCA

Загружаем датасет:
```{r}
dirs <- read.csv("https://raw.githubusercontent.com/creaciond/russian-drama/master/csv/annotated_dirs_full.csv", sep=";")
dirs.numeric <- dirs[c("Text", "ADJ", "ADVB", "INTJ", "NOUN", "PREP", "VERB")]
```

Корреляции между разными полями:
```{r}
ggpairs(dirs.numeric[,-1])
```

Ковариации:
```{r}
cov(dirs.numeric[,-1])
```

Корреляции
```{r}
cor(dirs.numeric[,-1])
```

#### 1.1. PCA и его результаты
```{r}
PCA <- prcomp(dirs.numeric[,-1])
summary(PCA)
```
Получается, что не обязательно использовать 6 частей речи — использование трёх даёт приближение в 83%, а четырёх — 94%.

```{r}
autoplot(PCA,
         shape = FALSE,
         loadings = TRUE,
         label = FALSE,
         loadings.label = TRUE)+
  theme_bw()
```
Получается, что самые независимые друг от друга параметры — это `NOUN`, `VERB` и `ADVB`. `PREP` находится довольно тесно к `NOUN` (что в общем-то имеет смысл), также близки `ADJ` и `ADVB`  (и то, и другое модифицируют значения — будь то именные группы или глаголы?..)

### 2. Кластеризация

Так данные выглядят, если оставить две компоненты:
```{r}
plot(PCA$x[, c(1,2)])
```

Если честно, пока что не выглядит как что-то, что можно кластеризовать, но попробуем.
По идее, эти данные (=ремарки) разбиты на 8 разных типов (=TEI type).
```{r}
dirs.2d <- PCA$x[, c(1,2)]
```
Кластеризуем при помощи k-means:
```{r}
set.seed(5)
n.cl <- kmeans(dirs.2d, centers = 8)
# n.cl$cluster
# n.cl$centers
```

Картинки:
```{r}
plot(dirs.2d,
     col = n.cl$cluster)
points(n.cl$centers, col = "brown", pch = 8, cex = 2)
```

Выглядит вполне разумно! 
Сравним с тем, как это всё раскрасится по типам, которые я разметила вручную.

```{r}
dirs.2d <- cbind(dirs.2d, dirs$TEI.type)
names(dirs.2d) <- c("PC1", "PC2", "TEI.type")
```

```{r}
plot(dirs.2d[, c(1,2)],
     col=dirs.2d[,3])
```
